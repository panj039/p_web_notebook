{% extends "base.html" %}

{% block title %}Search{% if query %} - {{ query }}{% endif %} - {{ APP_NAME }}{% endblock %}

{% block content %}
<div class="search-container">
    <div class="search-header">
        <h1>🔍 Search</h1>
    </div>

    <div class="search-form-section">
        <form action="{{ url_for('search') }}" method="GET" class="search-form">
            <input type="text" name="q" value="{{ query }}" placeholder="Search files and content..." 
                   class="search-input" autofocus>
            <button type="submit" class="btn btn-primary">Search</button>
        </form>
    </div>

    {% if query %}
        <div class="search-results">
            <h2>Results for "{{ query }}"</h2>
            {% if results %}
                <div class="results-count">Found {{ results|length }} result(s)</div>
                
                {% for result in results %}
                    <div class="search-result">
                        <div class="result-header">
                            <a href="{{ url_for('view_file', filepath=result.path) }}" class="result-title">
                                📄 {{ result.name }}
                            </a>
                            <span class="result-path">{{ result.path }}</span>
                        </div>
                        
                        {% if result.match_type == 'content' %}
                            <div class="result-context">
                                <div class="context-label">Line {{ result.line }}:</div>
                                <pre class="context-text">{{ result.context }}</pre>
                            </div>
                        {% elif result.match_type == 'filename' %}
                            <div class="result-match-type">Filename match</div>
                        {% endif %}
                        
                        <div class="result-actions">
                            <a href="{{ url_for('view_file', filepath=result.path) }}" class="btn btn-small">👁️ View</a>
                            <a href="{{ url_for('edit_file', filepath=result.path) }}" class="btn btn-small">✏️ Edit</a>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-results">
                    <p>No results found for "{{ query }}"</p>
                    <p>Try different keywords or <a href="{{ url_for('new_file') }}">create a new file</a>.</p>
                </div>
            {% endif %}
        </div>
    {% else %}
        <div class="search-help">
            <h3>Search Tips:</h3>
            <ul>
                <li>Search by filename or file content</li>
                <li>Use keywords that might appear in your files</li>
                <li>Search is case-insensitive</li>
            </ul>
        </div>
    {% endif %}

    <div class="search-actions">
        <a href="{{ url_for('index') }}" class="btn btn-secondary">🏠 Back to Home</a>
    </div>
</div>
{% endblock %}